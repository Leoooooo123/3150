<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Text I/O Functions | CSCI3150 - File System</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="./binary.html" />
    
    
    <link rel="prev" href="./intro.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="2.2"
        data-chapter-title="Text I/O Functions"
        data-filepath="text.md"
        data-basepath="."
        data-revision="Tue Nov 08 2016 18:19:27 GMT+0800 (HKT)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                
                        <i class="fa fa-check"></i>
                        
                        Goal of this lab
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Important commands</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="as.html">
            
                
                    <a href="./as.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        File permission
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="mount.html">
            
                
                    <a href="./mount.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        mount
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="stat.html">
            
                
                    <a href="./stat.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        stat
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="df.html">
            
                
                    <a href="./df.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        checking disk space utilization
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" >
            
            <span><b>2.</b> C functions to deal with files</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="intro.html">
            
                
                    <a href="./intro.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        C File I/O
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="2.2" data-path="text.html">
            
                
                    <a href="./text.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Text I/O Functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="binary.html">
            
                
                    <a href="./binary.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Binary I/O Functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="fseek.html">
            
                
                    <a href="./fseek.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        Getting data using fseek
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" >
            
            <span><b>3.</b> Linux file system calls</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="fd.html">
            
                
                    <a href="./fd.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        File descriptor
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="syscall.html">
            
                
                    <a href="./syscall.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Basic file functions
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="dir.html">
            
                
                    <a href="./dir.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Directory
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="refer.html">
            
                
                    <a href="./refer.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Reference
                    </a>
            
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >CSCI3150 - File System</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="text-io-functions">Text I/O Functions</h1>
<p>Text files are the normal files that you can easily create using simple text editors.</p>
<p>The text file I/O functions in the stdio library are as follows. You can look up their manual pages to see more details. We use three examples to show how these functions work.</p>
<table>
<tr>
  <td>Mode</td>
  <td>Description </td>
</tr>
  <tr>
    <td>feof</td>
    <td>detects end-of-file marker in a file</td>
  </tr>
  <tr>
    <td>fscanf</td>
    <td>reads formatted input from a file</td>
  </tr>
  <tr>
    <td>fprintf</td>
    <td>prints formatted output to a file</td>
  </tr>
  <tr>
    <td>fgets</td>
    <td>reads a string from a file</td>
  </tr>
  <tr>
    <td>fputs</td>
    <td> prints a string to a file</td>
  </tr>
  <tr>
    <td>fgetc</td>
    <td>reads a character from a file</td>
  </tr>
  <tr>
    <td>fputc</td>
    <td>prints a character to a file</td>
  </tr>
</table>

<p><a href="code/fgetc_cp.c"><code>fgetc_cp.c</code></a> use <code>fgetc(-)</code> and <code>fputc(-)</code> to copy files. <code>fputc(int char, FILE *stream)</code> writes a character (an unsigned char) specified by the argument char to the specified stream and advances the position indicator for the stream. Similarly, <code>fgetc(FILE *stream)</code> reads a character from the specified stread and advances the position indicator for the stream.</p>
<pre><code class="lang-c"><span class="hljs-comment">/*fgetc_cp.c*/</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span>
</span>{
    FILE * originfile, * copyfile;
    <span class="hljs-keyword">int</span> c;

    <span class="hljs-keyword">if</span>(argc!=<span class="hljs-number">2</span>){
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Useage: ./cp fileName\n&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }
    originfile = fopen(argv[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;r&quot;</span>);

    <span class="hljs-keyword">if</span> (originfile == <span class="hljs-literal">NULL</span>) {
        perror(<span class="hljs-string">&quot;fopen!\n&quot;</span>);
        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
    }

    copyfile = fopen(<span class="hljs-string">&quot;copyfile&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);

    <span class="hljs-keyword">if</span> (copyfile == <span class="hljs-literal">NULL</span>) {
        perror(<span class="hljs-string">&quot;fopen\n&quot;</span>);
        <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
    }
    <span class="hljs-keyword">while</span> ( (c=fgetc (originfile)) != EOF ){
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;%c&quot;</span>,c);
        fputc (c, copyfile);
    }

    fclose (copyfile);
    fclose ( originfile );
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><a href="code/fgets_cp.c"><code>fgets_cp.c</code></a> use <code>fgets(-)</code> and <code>fputs(-)</code> to copy files. <code>fputs(const char *str, FILE *stream)</code> writes a string to the specified stream up to but not including the null character. <code>char *fgets(char *str, int n, FILE *stream)</code> reads a line from the specified stream and stores it into the string pointed to by str. It stops when either (n-1) characters are read, the newline character is read, or the end-of-file is reached, whichever comes first.</p>
<pre><code class="lang-c"><span class="hljs-comment">/*fgets_cp.c*/</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span> <span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[] )</span></span>{
    FILE * originfile;
    FILE * copyfile;
    <span class="hljs-keyword">char</span> line [<span class="hljs-number">256</span>];

    <span class="hljs-keyword">if</span>(argc!=<span class="hljs-number">2</span>){
        <span class="hljs-built_in">printf</span>(<span class="hljs-string">&quot;Useage: ./cp fileName\n&quot;</span>);
        <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    }

  originfile = fopen(argv[<span class="hljs-number">1</span>], <span class="hljs-string">&quot;r&quot;</span>);
  <span class="hljs-keyword">if</span> (originfile == <span class="hljs-literal">NULL</span>) {
    perror(<span class="hljs-string">&quot;fopen!\n&quot;</span>);
    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
  }

  copyfile = fopen(<span class="hljs-string">&quot;copyfile&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);
  <span class="hljs-keyword">if</span> (copyfile == <span class="hljs-literal">NULL</span>) {
    perror(<span class="hljs-string">&quot;fopen\n&quot;</span>);
    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
  }


    <span class="hljs-keyword">while</span> ( fgets ( line, <span class="hljs-keyword">sizeof</span>(line), originfile ) != <span class="hljs-literal">NULL</span> ){
        <span class="hljs-built_in">fputs</span> ( line, <span class="hljs-built_in">stdout</span> );
        <span class="hljs-built_in">fprintf</span> (copyfile ,<span class="hljs-string">&quot;%s&quot;</span>, line);
    }

    fclose (copyfile);
    fclose ( originfile );
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>
<p><code>int fscanf(FILE *stream, const char *format, ...)</code> reads formatted input from a stream. It returns  the  number  of input items successfully matched and assigned, which can be fewer than provided for, or even zero in the event of an early matching failure. The value EOF is returned if the end of input is reached before either the first successful conversion or a matching failure occurs.  See the following example <a href="code/fscanf_cp.c"><code>fscanf_cp.c</code></a>. Please download the file <a href="code/inputlist"><code>inputlist</code></a> before you run the code.</p>
<pre><code class="lang-c"><span class="hljs-comment">/*fscanf_cp.c*/</span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdlib.h&gt;</span></span>
<span class="hljs-preprocessor">#<span class="hljs-keyword">include</span> <span class="hljs-string">&lt;stdio.h&gt;</span></span>

<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">(<span class="hljs-keyword">int</span> argc, <span class="hljs-keyword">char</span>* argv[])</span>
</span>{
  FILE * originfile, * copyfile;
  <span class="hljs-keyword">char</span> sid[<span class="hljs-number">11</span>];  
  <span class="hljs-keyword">int</span> score;

  originfile = fopen(<span class="hljs-string">&quot;inputlist&quot;</span>, <span class="hljs-string">&quot;r&quot;</span>);

  <span class="hljs-keyword">if</span> (originfile == <span class="hljs-literal">NULL</span>) {
    perror(<span class="hljs-string">&quot;fopen!\n&quot;</span>);
    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
  }

  copyfile = fopen(<span class="hljs-string">&quot;copyfile&quot;</span>, <span class="hljs-string">&quot;w&quot;</span>);

  <span class="hljs-keyword">if</span> (copyfile == <span class="hljs-literal">NULL</span>) {
    perror(<span class="hljs-string">&quot;fopen\n&quot;</span>);
    <span class="hljs-built_in">exit</span>(EXIT_FAILURE);
  }

  <span class="hljs-keyword">while</span> (<span class="hljs-built_in">fscanf</span>(originfile, <span class="hljs-string">&quot;%s %d&quot;</span>, sid, &amp;score) == <span class="hljs-number">2</span>) {
    <span class="hljs-built_in">fprintf</span>(copyfile, <span class="hljs-string">&quot;%s %d\n&quot;</span>, sid, score);
  }

  fclose(originfile);
  fclose(copyfile);

  <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}
</code></pre>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./intro.html" class="navigation navigation-prev " aria-label="Previous page: C File I/O"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./binary.html" class="navigation navigation-next " aria-label="Next page: Binary I/O Functions"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

    
    <script src="gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
